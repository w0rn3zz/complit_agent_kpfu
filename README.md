# 🤖 KFU IT Ticket Classifier v2.0

**Multi-Agent система для интеллектуальной классификации заявок в IT-поддержку КФУ**

Гибридная система на базе **ML модели (RuBERT + Logistic Regression)** и **GigaChat**, обеспечивающая точную классификацию IT-заявок через цепочку из 5 специализированных агентов.

## 🎬 Демонстрация работы

![Demo](https://i.pixsafe.online/album?album=uibDj&file=screen-recording-2025-12-05-at-140346-foulir.gif)

---

## 🎯 Решаемая проблема

При поступлении заявок на обслуживание ИТ-инфраструктуры КФУ существует проблема корректного определения класса заявки:
- ❌ Специалисты техподдержки тратят время на анализ вручную
- ❌ Аббревиатуры и сокращения усложняют понимание
- ❌ Сложные случаи требуют дополнительных уточнений
- ❌ Нет автоматизированной многоуровневой системы классификации

## ✨ Решение - 5 AI-агентов в цепочке

### Архитектура системы

```
Заявка пользователя
        ↓
┌───────────────────────────────────┐
│ 🎯 SystemControl (Оркестратор)    │
│ Управление цепочкой агентов       │
│ Маршрутизация между этапами       │
└───────────────────────────────────┘
        ↓
┌───────────────────────────────────┐
│ 1️⃣ AbbreviationConvert (GigaChat) │
│ Исправление аббревиатур           │
└───────────────────────────────────┘
        ↓
┌───────────────────────────────────┐
│ 2️⃣ TicketAnalyzer (ML)            │
│ RuBERT + Logistic Classifier      │
│ Порог: 90% уверенности            │
└───────────────────────────────────┘
        ↓ (если < 90%)
┌───────────────────────────────────┐
│ 3️⃣ DeepTicketAnalyzer (GigaChat)  │
│ Глубокий анализ с промптом        │
│ Порог: 90% уверенности            │
└───────────────────────────────────┘
        ↓ (если не определен)
┌───────────────────────────────────┐
│ 4️⃣ QuestionGenerator (GigaChat)   │
│ Генерация 3-5 уточняющих вопросов │
│ Финальная классификация           │
└───────────────────────────────────┘
        ↓
   ✅ Результат
```

---

## 🚀 Быстрый старт

### 1. Настройка переменных окружения

Скопируйте файл с примером и заполните API ключи:

```bash
cp .env.example .env
```

Отредактируйте `.env` и добавьте ваши ключи:
```env
GIGCHAT_API_KEY=your_gigachat_api_key_here
```

### 2. Запуск через Docker

Запустите всю систему одной командой:

```bash
docker-compose up --build -d
```

**⚠️ При первом запуске:**
- BERT модель (~112 MB) автоматически скачается из Hugging Face
- Это займет 2-5 минут в зависимости от скорости интернета
- Модель сохранится в Docker volume и больше не будет скачиваться

**📦 Что происходит при запуске:**
1. Backend скачивает RuBERT-tiny2 модель из HuggingFace
2. Модель кэшируется в Docker volume `models-cache`
3. При последующих запусках модель уже доступна
4. Classifier и tokenizer должны быть в `backend/data/models/`

### 3. Проверка работы

- **Frontend**: http://localhost:3000
- **API Docs**: http://localhost:8000/docs
- **API Health**: http://localhost:8000/api/v1/health

### Остановка

```bash
docker-compose down
```

---

## 📡 API Endpoints

### Классификация заявок
- **POST** `/api/v1/classify` - Классификация заявки через систему агентов
- **POST** `/api/v1/classify-with-answers` - Финальная классификация с ответами на вопросы
- **POST** `/api/v1/analyze-text` - Анализ текстовой заявки (legacy)

### Массовая обработка
- **POST** `/api/v1/analyze-excel` - Анализ заявок из Excel файла

### Мониторинг
- **GET** `/api/v1/health` - Проверка работоспособности сервиса
- **GET** `/` - Информация о системе и агентах

### Документация
- **GET** `/docs` - Swagger UI (интерактивная документация)
- **GET** `/redoc` - ReDoc (альтернативная документация)

---

## 🛠 Технологии

**Backend:**
- FastAPI - современный веб-фреймворк
- RuBERT-tiny2 - русскоязычная BERT модель (auto-download from HuggingFace)
- Scikit-learn - ML классификатор
- GigaChat - LLM для глубокого анализа
- Docker - контейнеризация с volume кэшированием

**Frontend:**
- Next.js 16 - React фреймворк
- TypeScript - типизация
- Tailwind CSS - стилизация
- Framer Motion - анимации

---

## 📊 Возможности системы

✅ **Автоматическая классификация** - до 90% точности с ML  
✅ **Интеллектуальный анализ** - GigaChat для сложных случаев  
✅ **Генерация вопросов** - уточнение неоднозначных заявок  
✅ **Обработка аббревиатур** - расшифровка сокращений КФУ  
✅ **Массовая обработка** - загрузка Excel файлов  
✅ **REST API** - готово к интеграции  
✅ **Docker** - простое развертывание  

---

Made with ❤️ for KFU
