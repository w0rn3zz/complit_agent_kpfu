from typing import List
from pydantic import BaseModel
from src.core.enums import WorkTypeCategory


class WorkType(BaseModel):
    """Тип работы из каталога"""
    id: str
    name: str
    category: WorkTypeCategory
    description: str
    keywords: List[str]
    examples: List[str]


# Каталог типов работ департамента информатизации и связи КФУ
WORK_TYPES_CATALOG: List[WorkType] = [
    # Железо
    WorkType(
        id="hw_001",
        name="Ремонт/замена компьютерной техники",
        category=WorkTypeCategory.HARDWARE,
        description="Проблемы с ПК, ноутбуками, мониторами, клавиатурами, мышами",
        keywords=["компьютер", "ноутбук", "монитор", "клавиатура", "мышь", "не работает", "сломался", "поломка"],
        examples=[
            "Не включается компьютер в аудитории 301",
            "Сломалась клавиатура на рабочем месте",
            "Монитор показывает артефакты"
        ]
    ),
    WorkType(
        id="hw_002",
        name="Проблемы с принтерами/сканерами",
        category=WorkTypeCategory.HARDWARE,
        description="Печать, сканирование, замена картриджей",
        keywords=["принтер", "сканер", "печать", "картридж", "замятие", "не печатает", "тонер"],
        examples=[
            "Принтер не печатает документы",
            "Замятие бумаги в принтере",
            "Закончился тонер в картридже"
        ]
    ),
    
    # Программное обеспечение
    WorkType(
        id="sw_001",
        name="Установка/обновление ПО",
        category=WorkTypeCategory.SOFTWARE,
        description="Установка программ, обновления Windows, драйверов",
        keywords=["установить", "обновить", "программа", "софт", "windows", "драйвер", "приложение"],
        examples=[
            "Нужно установить Microsoft Office",
            "Требуется обновление Windows",
            "Установка специализированного ПО для работы"
        ]
    ),
    WorkType(
        id="sw_002",
        name="Проблемы с 1С",
        category=WorkTypeCategory.SOFTWARE,
        description="Ошибки, настройка, обновление 1С",
        keywords=["1с", "бухгалтерия", "зуп", "документооборот", "ошибка 1с"],
        examples=[
            "Не открывается 1С:Бухгалтерия",
            "Ошибка при проведении документа в 1С",
            "Нужна настройка 1С:ЗУП"
        ]
    ),
    WorkType(
        id="sw_003",
        name="Проблемы с электронной почтой",
        category=WorkTypeCategory.SOFTWARE,
        description="Настройка почты, проблемы с доступом",
        keywords=["почта", "email", "outlook", "письма", "не приходят", "не отправляется"],
        examples=[
            "Не могу отправить письмо",
            "Не приходят письма на корпоративную почту",
            "Настройка почтового клиента Outlook"
        ]
    ),
    
    # Сеть и интернет
    WorkType(
        id="net_001",
        name="Проблемы с интернетом/сетью",
        category=WorkTypeCategory.NETWORK,
        description="Отсутствие интернета, медленная скорость, проблемы с WiFi",
        keywords=["интернет", "сеть", "wifi", "вайфай", "нет доступа", "медленный", "не грузит"],
        examples=[
            "Нет доступа к интернету в кабинете",
            "Очень медленный интернет",
            "WiFi постоянно отключается"
        ]
    ),
    WorkType(
        id="net_002",
        name="Настройка сетевого оборудования",
        category=WorkTypeCategory.NETWORK,
        description="Роутеры, коммутаторы, точки доступа",
        keywords=["роутер", "коммутатор", "switch", "точка доступа", "сетевое оборудование"],
        examples=[
            "Настройка нового роутера",
            "Не работает сетевой коммутатор",
            "Требуется добавить точку доступа WiFi"
        ]
    ),
    
    # Доступы и учетные записи
    WorkType(
        id="acc_001",
        name="Создание/восстановление учетной записи",
        category=WorkTypeCategory.ACCESS,
        description="Создание аккаунтов, восстановление паролей, заблокированные учетки",
        keywords=["учетная запись", "аккаунт", "пароль", "забыл пароль", "заблокирован", "доступ"],
        examples=[
            "Забыл пароль от учетной записи",
            "Нужно создать аккаунт для нового сотрудника",
            "Учетная запись заблокирована"
        ]
    ),
    WorkType(
        id="acc_002",
        name="Права доступа к ресурсам",
        category=WorkTypeCategory.ACCESS,
        description="Доступ к папкам, базам данных, системам",
        keywords=["доступ", "права", "разрешения", "папка", "база данных", "система", "нет доступа"],
        examples=[
            "Нужен доступ к общей папке отдела",
            "Не могу открыть базу данных",
            "Требуются права администратора"
        ]
    ),
    
    # Консультации
    WorkType(
        id="cons_001",
        name="Консультация по работе с ПО",
        category=WorkTypeCategory.CONSULTATION,
        description="Вопросы по использованию программ и систем",
        keywords=["как", "помогите", "подскажите", "консультация", "вопрос", "научите"],
        examples=[
            "Как работать с электронным документооборотом?",
            "Подскажите, как настроить почту на телефоне",
            "Нужна помощь в работе с личным кабинетом"
        ]
    ),
    
    # Веб-ресурсы КФУ
    WorkType(
        id="web_001",
        name="Проблемы с сайтом КФУ",
        category=WorkTypeCategory.SOFTWARE,
        description="Ошибки на сайте, недоступность, некорректное отображение",
        keywords=["сайт", "портал", "кпфу", "страница", "не открывается", "ошибка на сайте"],
        examples=[
            "Не открывается личный кабинет на сайте КФУ",
            "Ошибка 404 на странице",
            "Некорректно отображается информация на портале"
        ]
    ),
    
    # Видеосвязь и конференции
    WorkType(
        id="comm_001",
        name="Проблемы с видеосвязью",
        category=WorkTypeCategory.SOFTWARE,
        description="Zoom, Teams, другие системы видеоконференций",
        keywords=["zoom", "teams", "видеосвязь", "конференция", "не слышно", "не видно", "камера"],
        examples=[
            "Не работает камера в Zoom",
            "Не слышно звук на видеоконференции",
            "Проблемы с подключением к Teams"
        ]
    ),
]


# Примеры заявок, НЕ относящихся к компетенции департамента
NON_IT_EXAMPLES = [
    "Протекает кран в туалете",
    "Не работает отопление в аудитории",
    "Сломался замок на двери",
    "Нужно заказать канцтовары",
    "Вопрос по начислению зарплаты",
    "Проблема с расписанием занятий",
]


def get_work_type_by_id(work_type_id: str) -> WorkType | None:
    """Получить тип работы по ID"""
    for wt in WORK_TYPES_CATALOG:
        if wt.id == work_type_id:
            return wt
    return None


def get_all_work_types() -> List[WorkType]:
    """Получить все типы работ"""
    return WORK_TYPES_CATALOG


def get_work_types_by_category(category: WorkTypeCategory) -> List[WorkType]:
    """Получить типы работ по категории"""
    return [wt for wt in WORK_TYPES_CATALOG if wt.category == category]
